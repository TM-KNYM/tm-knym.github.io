<!DOCTYPE html>
<html class="no-js consumer" lang="en">
<head>
<meta charset="utf-8">
<title>FlashLight</title>
    <meta content="initial-scale=1, minimum-scale=1, width=device-width" name="viewport">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<script type='text/javascript' src="https://code.jquery.com/jquery-2.1.4.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.1/css/materialize.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.1/js/materialize.min.js">
</script>
<style>
body {
    display: flex;
    min-height: 100vh;
    flex-direction: column;
}
main {
    flex: 1 0 auto;
}
canvas#canvas{
    background-color:white;
    width:600px;
    height:600px;
}
</style>
</head>
<body>
  <canvas id='canvas' width='600px' height='600px'></canvas>
  <div class='container'>
      <div class="row">
        <div class="col s2">
            <br>
        </div>
        <div class="col s8">
           </div>
            <div class="card-action center">
                <div onclick="rec_voice()" class="btn-floating btn-large waves-effect waves-light red"><i class="material-icons">keyboard_voice</i></div>
            </div>
          </div>
          
        </div>
        <div class="col s2">
            <br>
        </div>
      </div>
  </div>
  <div class="footer-copyright center-align ">
    c 2014 Copyright Chiyuru
  </div>
<script>
var WIDTH = 400;
var HEIGHT = 400;
var length = 150;
var size = 4;
var COL = 4;
var ROW = 4;

function rec_voice(){
recognition.start();
}


function createControlObj(drawFunc, updateFunc){
        return {
            draw : drawFunc,
            update : updateFunc
        }
    }

function GridControl(ctx, length, size){
     var drawFunc = function(){
              ctx.beginPath();
              var  max = length*size;
              for(var i=1; i<=size; i++ ){
                  ctx.moveTo(length * i, 0);
                  ctx.lineTo(length * i, max);
                  ctx.moveTo(0, length*i);
                  ctx.lineTo(max, length*i);
              }
              ctx.closePath();
              ctx.stroke();
          }
     var updateFunc = drawFunc;
    return createControlObj(drawFunc, updateFunc)
}

function CharControl(ctx,length){
    var drawFunc = function(){
        var x = this.col * length ;
        var y = this.row * length ;
        ctx.fillStyle = 'rgb(255,0,255)';
        ctx.fillRect(x,y,length, length);
    }
    var updateFunc = function(notification){
           var x = this.col * length ;
           var y = this.row * length ;
           ctx.clearRect(x,y,length, length);
           
           this.col = notification.col;
           this.row = notification.row;
           var x = this.col * length ;
           var y = this.row * length ;
           ctx.fillStyle = 'rgb(255,0,255)';
           ctx.fillRect(x,y,length, length);
    }

    var obj = createControlObj(drawFunc, updateFunc)
        obj.col = 0;
        obj.row = 0;
        obj.lenth = length;
    return obj;
}


/**
   draw canvas
  */
function init(instraction){
	var canvas = document.getElementById('canvas');
	var ctx = canvas.getContext('2d');

    
    
    var ctrlList = [];
    var charCtrl = CharControl(ctx, length);
    var gridCtrl = GridControl(ctx, length, size);
    ctrlList.push(charCtrl);
    ctrlList.push(gridCtrl);

    for(var i=0; i<ctrlList.length; i++){
        ctrlList[i].draw();
    }

   var updater =  function(){
        var notification = {
            col: instraction.pos.x,
            row: instraction.pos.y
        }
        for(var i=0;i< ctrlList.length; i++){
            ctrlList[i].update(notification);
        }
    }
    var time = setInterval(updater,2000);
}
document.body.addEventListener('touchstart', function(event) {
  event.preventDefault();
});

var instraction = {
    pos: {x:2,y:2}
}


var recognition = new webkitSpeechRecognition();
  recognition.lang = 'en-US';
  recognition.continuous = false;
  recognition.interimResults = true;
recognition.onstart = function(event){ 
    console.log("onstart", event);
}; 
recognition.onresult = function(event){
    var text = event.results.item(0).item(0).transcript;
    alert(text);
    if(text === 'change'){
        instraction.pos.x = Math.floor( Math.random() * size)
        instraction.pos.y = Math.floor( Math.random() * size)
    }
};

init(instraction);
</script>

</body>
</html>
